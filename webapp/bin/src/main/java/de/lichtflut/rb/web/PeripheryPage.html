<!--

    Copyright (C) 2011 lichtflut Forschungs- und Entwicklungsgesellschaft mbH

-->
<html xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.5-strict.dtd" >
    <head>  
        <title>Sample Resource</title>
        <script type="text/javascript" src="js/jit.js"></script>
        <link rel="stylesheet" type="text/css"href="css/lfrb.css">
        <link rel="stylesheet" type="text/css"href="css/periphery.css">
    </head>
    <body onload="initGraph()">
    
        <h1>Periphery</h1>
        
        <div id="periphery-view">
        
            <div id="infovis"></div>
        
            <div id="inner-details" class="info-box"></div>
        
        </div>
        
        <script type="text/javascript" wicket:id="jsonTree">
        </script>
        
        <script type="text/javascript">
        
        function initGraph() {
         var rgraph = new $jit.ForceDirected({
        //Where to append the visualization
        injectInto: 'infovis',
        //Optional: create a background canvas that plots
        //concentric circles.
        background: {
          CanvasStyles: {
            strokeStyle: '#555'
          }
        },
        //Add navigation capabilities:
        //zooming by scrolling and panning.
        Navigation: {
          enable: true,
          panning: true,
          zooming: 10
        },
        //Set Node and Edge styles.
        Node: {
        },
        
        Edge: {
          lineWidth:1.5
        },

        onBeforeCompute: function(node){
            //Add the relation list in the right column.
            //This list is taken from the data property of each JSON node.
            $jit.id('inner-details').innerHTML = node.id;
        },
        
        onAfterCompute: function(){
        },
        //Add the name of the node in the correponding label
        //and a click handler to move the graph.
        //This method is called once, on label creation.
        onCreateLabel: function(domElement, node){
            domElement.innerHTML = node.name;
            //domElement.onclick = function(){
            //    rgraph.onClick(node.id);
            //};
        },
        onDragMove: function(node, eventInfo, e) {  
            var pos = eventInfo.getPos();  
            node.pos.setc(pos.x, pos.y);  
            fd.plot();  
        },  
        //Change some label dom properties.
        //This method is called each time a label is plotted.
        onPlaceLabel: function(domElement, node){
            var style = domElement.style;
            style.display = '';
            style.cursor = 'pointer';

            if (node._depth <= 1) {
                style.fontSize = "7pt";
                style.color = "#111";
            
            } else if(node._depth == 2){
                style.fontSize = "6pt";
                style.color = "#555";
            
            } else {
                style.display = 'none';
            }

            var left = parseInt(style.left);
            var w = domElement.offsetWidth;
            style.left = (left - w / 2) + 'px';
        }
    });
    //load JSON data
    rgraph.loadJSON(graph);
    //trigger small animation
    rgraph.graph.eachNode(function(n) {
      var pos = n.getPos();
      pos.setc(-200, -200);
    });
    rgraph.compute('end');
    rgraph.fx.animate({
      modes:['polar'],
      duration: 2000
    });
    //end
    //append information about the root relations in the right column
    $jit.id('inner-details').innerHTML = rgraph.graph.getNode(rgraph.root).id;
    }
    </script>
    </body>
</html>
